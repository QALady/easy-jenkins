# Building easy-jenkins inside easy-jenkins

This document contains instructions for building easy-jenkins inside easy-jenkins.

This procedure may be useful to verify non-regressions of a new feature/bugfix before merging it to the master branch.

## Preparation

Install easy-jenkins from https://github.com/gmacario/easy-jenkins

Refer to [preparation.md](https://github.com/gmacario/easy-jenkins/blob/master/docs/preparation.md) for details.

## Step-by-step instructions

### Configure project `build_easyjenkins_freestyle`

* Browse `${JENKINS_URL}`, then click **New Item**
  - Item name: `build_easyjenkins_freestyle`
  - Type: **Freestyle project**

  then click **OK**.
  
**TODO**: Configure a Pipeline instead than a Freestyle project
  
* Inside the project configuration page, fill-in the following information:
  - Discard Old Builds: Yes
    - Strategy: Log Rotation
      - Days to keep builds: (none)
      - Max # of builds to keep: 10
  - Restrict where this project can be run: `master` (TODO: Define and use label `docker`)
  - Source Code Management: Git
    - Repositories
      - Repository URL: `https://github.com/gmacario/easy-jenkins`
      - Credentials: - none -
      - Branches to build
        - Branch Specifier (blank for `any`): `*/master` (TODO?)
      - Repository browser: (Auto)
  - Build
    - Add build step > Execute shell
      - Command

```
#!/bin/bash -xe

docker-compose build --pull
./runme.sh

# EOF
```
  
  then click **Save**

### Build project `build_easyjenkins_freestyle`

<!-- (2016-02-18 17:24 CET) -->

* Browse `${JENKINS_URL}/job/build_easyjenkins_freestyle`, then click **Build Now**

Result: SUCCESS

```
Started by user anonymous
[EnvInject] - Loading node environment variables.
Building on master in workspace /var/jenkins_home/jobs/build_easyjenkins_freestyle/workspace
Cloning the remote Git repository
Cloning repository https://github.com/gmacario/easy-jenkins
 > git init /var/jenkins_home/jobs/build_easyjenkins_freestyle/workspace # timeout=10
Fetching upstream changes from https://github.com/gmacario/easy-jenkins
 > git --version # timeout=10
 > git -c core.askpass=true fetch --tags --progress https://github.com/gmacario/easy-jenkins +refs/heads/*:refs/remotes/origin/*
 > git config remote.origin.url https://github.com/gmacario/easy-jenkins # timeout=10
 > git config --add remote.origin.fetch +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git config remote.origin.url https://github.com/gmacario/easy-jenkins # timeout=10
Fetching upstream changes from https://github.com/gmacario/easy-jenkins
 > git -c core.askpass=true fetch --tags --progress https://github.com/gmacario/easy-jenkins +refs/heads/*:refs/remotes/origin/*
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
 > git rev-parse refs/remotes/origin/origin/master^{commit} # timeout=10
Checking out Revision bf180199c67e8b63b5884defd5c1d61a20d1120e (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f bf180199c67e8b63b5884defd5c1d61a20d1120e
First time build. Skipping changelog.
[workspace] $ /bin/bash -xe /tmp/hudson377287532669826113.sh
+ docker-compose build --pull
Building myjenkins
Step 1 : FROM jenkins:latest
latest: Pulling from library/jenkins
Digest: sha256:07df97d0212db136ffd0768aa6931ab8c27d1f05ee9fa403c9611d3744e647b8
Status: Downloaded newer image for jenkins:latest
 ---> c005bfc69a3e
Step 2 : MAINTAINER Gianpaolo Macario <gmacario@gmail.com>
 ---> Running in 288e348f7dfb
 ---> 2d54a71d0e69
Removing intermediate container 288e348f7dfb
Step 3 : USER root
 ---> Running in fe9907d7d26c
 ---> c8bc0c1df3c7
Removing intermediate container fe9907d7d26c
Step 4 : RUN apt-get update -qq && apt-get install -qqy     apt-transport-https     ca-certificates     curl     wget     lxc     iptables     dos2unix     groovy2
 ---> Running in 6b795adde380
[91mdebconf: delaying package configuration, since apt-utils is not installed
[0mSelecting previously unselected package libmpdec2:amd64.
(Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 17474 files and directories currently installed.)
Preparing to unpack .../libmpdec2_2.4.1-1_amd64.deb ...
Unpacking libmpdec2:amd64 (2.4.1-1) ...
Selecting previously unselected package libnfnetlink0:amd64.
Preparing to unpack .../libnfnetlink0_1.0.1-3_amd64.deb ...
Unpacking libnfnetlink0:amd64 (1.0.1-3) ...
Selecting previously unselected package libpython3.4-minimal:amd64.
Preparing to unpack .../libpython3.4-minimal_3.4.2-1_amd64.deb ...
Unpacking libpython3.4-minimal:amd64 (3.4.2-1) ...
Selecting previously unselected package libpython3.4-stdlib:amd64.
Preparing to unpack .../libpython3.4-stdlib_3.4.2-1_amd64.deb ...
Unpacking libpython3.4-stdlib:amd64 (3.4.2-1) ...
Selecting previously unselected package libseccomp2:amd64.
Preparing to unpack .../libseccomp2_2.1.1-1_amd64.deb ...
Unpacking libseccomp2:amd64 (2.1.1-1) ...
Selecting previously unselected package init-system-helpers.
Preparing to unpack .../init-system-helpers_1.22_all.deb ...
Unpacking init-system-helpers (1.22) ...
Selecting previously unselected package libapparmor1:amd64.
Preparing to unpack .../libapparmor1_2.9.0-3_amd64.deb ...
Unpacking libapparmor1:amd64 (2.9.0-3) ...
Selecting previously unselected package python3.4-minimal.
Preparing to unpack .../python3.4-minimal_3.4.2-1_amd64.deb ...
Unpacking python3.4-minimal (3.4.2-1) ...
Selecting previously unselected package python3.4.
Preparing to unpack .../python3.4_3.4.2-1_amd64.deb ...
Unpacking python3.4 (3.4.2-1) ...
Selecting previously unselected package python3-minimal.
Preparing to unpack .../python3-minimal_3.4.2-2_amd64.deb ...
Unpacking python3-minimal (3.4.2-2) ...
Selecting previously unselected package libpython3-stdlib:amd64.
Preparing to unpack .../libpython3-stdlib_3.4.2-2_amd64.deb ...
Unpacking libpython3-stdlib:amd64 (3.4.2-2) ...
Selecting previously unselected package dh-python.
Preparing to unpack .../dh-python_1.20141111-2_all.deb ...
Unpacking dh-python (1.20141111-2) ...
Selecting previously unselected package python3.
Preparing to unpack .../python3_3.4.2-2_amd64.deb ...
Unpacking python3 (3.4.2-2) ...
Selecting previously unselected package lxc.
Preparing to unpack .../lxc_1%3a1.0.6-6+deb8u2_amd64.deb ...
Unpacking lxc (1:1.0.6-6+deb8u2) ...
Selecting previously unselected package libyaml-snake-java.
Preparing to unpack .../libyaml-snake-java_1.12-2_all.deb ...
Unpacking libyaml-snake-java (1.12-2) ...
Selecting previously unselected package libxtables10.
Preparing to unpack .../libxtables10_1.4.21-2+b1_amd64.deb ...
Unpacking libxtables10 (1.4.21-2+b1) ...
Selecting previously unselected package iptables.
Preparing to unpack .../iptables_1.4.21-2+b1_amd64.deb ...
Unpacking iptables (1.4.21-2+b1) ...
Selecting previously unselected package ant.
Preparing to unpack .../archives/ant_1.9.4-3_all.deb ...
Unpacking ant (1.9.4-3) ...
Selecting previously unselected package ant-optional.
Preparing to unpack .../ant-optional_1.9.4-3_all.deb ...
Unpacking ant-optional (1.9.4-3) ...
Selecting previously unselected package libantlr-java.
Preparing to unpack .../libantlr-java_2.7.7+dfsg-6_all.deb ...
Unpacking libantlr-java (2.7.7+dfsg-6) ...
Selecting previously unselected package antlr.
Preparing to unpack .../antlr_2.7.7+dfsg-6_all.deb ...
Unpacking antlr (2.7.7+dfsg-6) ...
Selecting previously unselected package apt-transport-https.
Preparing to unpack .../apt-transport-https_1.0.9.8.2_amd64.deb ...
Unpacking apt-transport-https (1.0.9.8.2) ...
Selecting previously unselected package libasm4-java.
Preparing to unpack .../libasm4-java_5.0.3-1_all.deb ...
Unpacking libasm4-java (5.0.3-1) ...
Selecting previously unselected package libapache-pom-java.
Preparing to unpack .../libapache-pom-java_10-2_all.deb ...
Unpacking libapache-pom-java (10-2) ...
Selecting previously unselected package libbsf-java.
Preparing to unpack .../libbsf-java_1%3a2.4.0-5_all.deb ...
Unpacking libbsf-java (1:2.4.0-5) ...
Selecting previously unselected package libcommons-parent-java.
Preparing to unpack .../libcommons-parent-java_22-2_all.deb ...
Unpacking libcommons-parent-java (22-2) ...
Selecting previously unselected package libcommons-lang-java.
Preparing to unpack .../libcommons-lang-java_2.6-4_all.deb ...
Unpacking libcommons-lang-java (2.6-4) ...
Selecting previously unselected package libcommons-cli-java.
Preparing to unpack .../libcommons-cli-java_1.2-3_all.deb ...
Unpacking libcommons-cli-java (1.2-3) ...
Selecting previously unselected package libcommons-logging-java.
Preparing to unpack .../libcommons-logging-java_1.2-1_all.deb ...
Unpacking libcommons-logging-java (1.2-1) ...
Selecting previously unselected package libhamcrest-java.
Preparing to unpack .../libhamcrest-java_1.3-5_all.deb ...
Unpacking libhamcrest-java (1.3-5) ...
Selecting previously unselected package junit4.
Preparing to unpack .../archives/junit4_4.11-3_all.deb ...
Unpacking junit4 (4.11-3) ...
Selecting previously unselected package libservlet2.5-java.
Preparing to unpack .../libservlet2.5-java_6.0.41-3_all.deb ...
Unpacking libservlet2.5-java (6.0.41-3) ...
Selecting previously unselected package libhawtjni-runtime-java.
Preparing to unpack .../libhawtjni-runtime-java_1.10-1_all.deb ...
Unpacking libhawtjni-runtime-java (1.10-1) ...
Selecting previously unselected package libjansi-native-java.
Preparing to unpack .../libjansi-native-java_1.0-4_all.deb ...
Unpacking libjansi-native-java (1.0-4) ...
Selecting previously unselected package libjansi-java.
Preparing to unpack .../libjansi-java_1.4-3_all.deb ...
Unpacking libjansi-java (1.4-3) ...
Selecting previously unselected package libjline2-java.
Preparing to unpack .../libjline2-java_2.11-2_all.deb ...
Unpacking libjline2-java (2.11-2) ...
Selecting previously unselected package libxpp3-java.
Preparing to unpack .../libxpp3-java_1.1.4c-2_all.deb ...
Unpacking libxpp3-java (1.1.4c-2) ...
Selecting previously unselected package libxstream-java.
Preparing to unpack .../libxstream-java_1.4.7-2_all.deb ...
Unpacking libxstream-java (1.4.7-2) ...
Selecting previously unselected package ivy.
Preparing to unpack .../archives/ivy_2.3.0-4_all.deb ...
Unpacking ivy (2.3.0-4) ...
Selecting previously unselected package libqdox-java.
Preparing to unpack .../libqdox-java_1.12-1_all.deb ...
Unpacking libqdox-java (1.12-1) ...
Selecting previously unselected package groovy2.
Preparing to unpack .../groovy2_2.2.2+dfsg-3+deb8u1_all.deb ...
Unpacking groovy2 (2.2.2+dfsg-3+deb8u1) ...
Selecting previously unselected package libbsh-java.
Preparing to unpack .../libbsh-java_2.0b4-15_all.deb ...
Unpacking libbsh-java (2.0b4-15) ...
Selecting previously unselected package libjcommander-java.
Preparing to unpack .../libjcommander-java_1.35-1_all.deb ...
Unpacking libjcommander-java (1.35-1) ...
Selecting previously unselected package rsync.
Preparing to unpack .../rsync_3.1.1-3_amd64.deb ...
Unpacking rsync (3.1.1-3) ...
Selecting previously unselected package testng.
Preparing to unpack .../testng_6.8.8-4_all.deb ...
Unpacking testng (6.8.8-4) ...
Selecting previously unselected package debootstrap.
Preparing to unpack .../debootstrap_1.0.67_all.deb ...
Unpacking debootstrap (1.0.67) ...
Selecting previously unselected package dos2unix.
Preparing to unpack .../dos2unix_6.0.4-1_amd64.deb ...
Unpacking dos2unix (6.0.4-1) ...
Processing triggers for mime-support (3.58) ...
Processing triggers for systemd (215-17+deb8u3) ...
Setting up libmpdec2:amd64 (2.4.1-1) ...
Setting up libnfnetlink0:amd64 (1.0.1-3) ...
Setting up libpython3.4-minimal:amd64 (3.4.2-1) ...
Setting up libpython3.4-stdlib:amd64 (3.4.2-1) ...
Setting up libseccomp2:amd64 (2.1.1-1) ...
Setting up init-system-helpers (1.22) ...
Setting up libapparmor1:amd64 (2.9.0-3) ...
Setting up python3.4-minimal (3.4.2-1) ...
Setting up python3.4 (3.4.2-1) ...
Setting up python3-minimal (3.4.2-2) ...
Setting up libpython3-stdlib:amd64 (3.4.2-2) ...
Setting up libyaml-snake-java (1.12-2) ...
Setting up libxtables10 (1.4.21-2+b1) ...
Setting up iptables (1.4.21-2+b1) ...
Setting up ant (1.9.4-3) ...
Setting up ant-optional (1.9.4-3) ...
Setting up libantlr-java (2.7.7+dfsg-6) ...
Setting up antlr (2.7.7+dfsg-6) ...
Setting up apt-transport-https (1.0.9.8.2) ...
Setting up libasm4-java (5.0.3-1) ...
Setting up libapache-pom-java (10-2) ...
Setting up libbsf-java (1:2.4.0-5) ...
Setting up libcommons-parent-java (22-2) ...
Setting up libcommons-lang-java (2.6-4) ...
Setting up libcommons-cli-java (1.2-3) ...
Setting up libcommons-logging-java (1.2-1) ...
Setting up libhamcrest-java (1.3-5) ...
Setting up junit4 (4.11-3) ...
Setting up libservlet2.5-java (6.0.41-3) ...
Setting up libhawtjni-runtime-java (1.10-1) ...
Setting up libjansi-native-java (1.0-4) ...
Setting up libjansi-java (1.4-3) ...
Setting up libjline2-java (2.11-2) ...
Setting up libxpp3-java (1.1.4c-2) ...
Setting up libxstream-java (1.4.7-2) ...
Setting up ivy (2.3.0-4) ...
Setting up libqdox-java (1.12-1) ...
Setting up groovy2 (2.2.2+dfsg-3+deb8u1) ...
update-alternatives: using /usr/share/groovy2/bin/groovy to provide /usr/bin/groovy (groovy) in auto mode
update-alternatives: using /usr/share/groovy2/bin/groovyc to provide /usr/bin/groovyc (groovyc) in auto mode
update-alternatives: using /usr/share/groovy2/bin/grape to provide /usr/bin/grape (grape) in auto mode
update-alternatives: using /usr/share/groovy2/bin/startGroovy to provide /usr/bin/startGroovy (startGroovy) in auto mode
update-alternatives: using /usr/share/groovy2/bin/groovysh to provide /usr/bin/groovysh (groovysh) in auto mode
update-alternatives: using /usr/share/groovy2/bin/java2groovy to provide /usr/bin/java2groovy (java2groovy) in auto mode
update-alternatives: using /usr/share/groovy2/bin/groovyConsole to provide /usr/bin/groovyConsole (groovyConsole) in auto mode
update-alternatives: using /usr/share/groovy2/bin/groovydoc to provide /usr/bin/groovydoc (groovydoc) in auto mode
Setting up libbsh-java (2.0b4-15) ...
Setting up libjcommander-java (1.35-1) ...
Setting up rsync (3.1.1-3) ...
invoke-rc.d: policy-rc.d denied execution of restart.
Setting up testng (6.8.8-4) ...
Setting up debootstrap (1.0.67) ...
Setting up dos2unix (6.0.4-1) ...
Setting up python3 (3.4.2-2) ...
running python rtupdate hooks for python3.4...
running python post-rtupdate hooks for python3.4...
Setting up lxc (1:1.0.6-6+deb8u2) ...
Setting up dh-python (1.20141111-2) ...
Processing triggers for libc-bin (2.19-18+deb8u3) ...
Processing triggers for systemd (215-17+deb8u3) ...
 ---> 78eea7f8aba6
Removing intermediate container 6b795adde380
Step 5 : RUN wget -qO- https://get.docker.com/ | sh
 ---> Running in 5babc8407fc1
[91m+ [0m[91msh -c apt-key adv --keyserver hkp://pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D || apt-key adv --keyserver hkp://pgp.mit.edu:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
[0mExecuting: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.b0JCuKrnxo --no-auto-check-trustdb --trust-model always --primary-keyring /etc/apt/trusted.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-security-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-stable.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-squeeze-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-squeeze-stable.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-wheezy-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-wheezy-stable.gpg --keyserver hkp://pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
[91mgpg: requesting key 2C52609D from hkp server pool.sks-keyservers.net
[0mgpgkeys: key 58118E89F3A912897C070ADBF76221572C52609D can't be retrieved
[91mgpg: no valid OpenPGP data found.
gpg: Total number processed: 0
[0mExecuting: gpg --ignore-time-conflict --no-options --no-default-keyring --homedir /tmp/tmp.1d0CK9fnPT --no-auto-check-trustdb --trust-model always --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-security-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-jessie-stable.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-squeeze-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-squeeze-stable.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-wheezy-automatic.gpg --keyring /etc/apt/trusted.gpg.d/debian-archive-wheezy-stable.gpg --keyserver hkp://pgp.mit.edu:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D
[91mgpg: [0m[91mrequesting key 2C52609D from hkp server pgp.mit.edu
[0m[91mgpg: key 2C52609D: public key "Docker Release Tool (releasedocker) <docker@docker.com>" imported
gpg: Total number processed: 1
gpg:               imported: 1  (RSA: 1)
[0m[91m+ sh -c mkdir -p /etc/apt/sources.list.d
[0m[91m+ [0m[91mdpkg --print-architecture
[0m[91m+ sh -c echo deb [arch=amd64] https://apt.dockerproject.org/repo debian-jessie main > /etc/apt/sources.list.d/docker.list
[0m[91m+ sh -c sleep 3; apt-get update; apt-get install -y -q docker-engine
[0mHit http://security.debian.org jessie/updates InRelease
Get:1 https://apt.dockerproject.org debian-jessie InRelease [454 B]
Ign https://apt.dockerproject.org debian-jessie InRelease
Get:2 https://apt.dockerproject.org debian-jessie Release.gpg [801 B]
Get:3 http://security.debian.org jessie/updates/main amd64 Packages [261 kB]
Ign http://httpredir.debian.org jessie InRelease
Get:4 http://httpredir.debian.org jessie-updates InRelease [136 kB]
Get:5 https://apt.dockerproject.org debian-jessie Release [19.7 kB]
Get:6 https://apt.dockerproject.org debian-jessie/main amd64 Packages [3668 B]
Get:7 http://httpredir.debian.org jessie-backports InRelease [166 kB]
Hit http://httpredir.debian.org jessie Release.gpg
Hit http://httpredir.debian.org jessie Release
Get:8 http://httpredir.debian.org jessie-updates/main amd64 Packages [3619 B]
Get:9 http://httpredir.debian.org jessie-backports/main amd64 Packages [547 kB]
Get:10 http://httpredir.debian.org jessie/main amd64 Packages [9034 kB]
Fetched 10.2 MB in 5s (2011 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  aufs-tools busybox cgroupfs-mount cpio initramfs-tools klibc-utils kmod
  libklibc libnih-dbus1 libnih1 makedev mountall plymouth xz-utils
Suggested packages:
  libarchive1 bash-completion desktop-base plymouth-themes
Recommended packages:
  yubico-piv-tool
The following NEW packages will be installed:
  aufs-tools busybox cgroupfs-mount cpio docker-engine initramfs-tools
  klibc-utils kmod libklibc libnih-dbus1 libnih1 makedev mountall plymouth
  xz-utils
0 upgraded, 15 newly installed, 0 to remove and 0 not upgraded.
Need to get 10.3 MB of archives.
After this operation, 47.4 MB of additional disk space will be used.
Get:1 http://httpredir.debian.org/debian/ jessie/main makedev all 2.3.1-93 [42.6 kB]
Get:2 https://apt.dockerproject.org/repo/ debian-jessie/main docker-engine amd64 1.10.1-0~jessie [8572 kB]
Get:3 http://httpredir.debian.org/debian/ jessie/main kmod amd64 18-3 [86.2 kB]
Get:4 http://httpredir.debian.org/debian/ jessie/main busybox amd64 1:1.22.0-9+deb8u1 [391 kB]
Get:5 http://httpredir.debian.org/debian/ jessie/main libklibc amd64 2.0.4-2 [51.7 kB]
Get:6 http://httpredir.debian.org/debian/ jessie/main plymouth amd64 0.9.0-9 [189 kB]
Get:7 http://httpredir.debian.org/debian/ jessie/main klibc-utils amd64 2.0.4-2 [108 kB]
Get:8 http://httpredir.debian.org/debian/ jessie/main cpio amd64 2.11+dfsg-4.1 [176 kB]
Get:9 http://httpredir.debian.org/debian/ jessie/main mountall amd64 2.54 [68.3 kB]
Get:10 http://httpredir.debian.org/debian/ jessie/main initramfs-tools all 0.120 [95.7 kB]
Get:11 http://httpredir.debian.org/debian/ jessie/main libnih-dbus1 amd64 1.0.3-4.3 [97.1 kB]
Get:12 http://httpredir.debian.org/debian/ jessie/main xz-utils amd64 5.1.1alpha+20120614-2+b3 [221 kB]
Get:13 http://httpredir.debian.org/debian/ jessie/main cgroupfs-mount all 1.1 [4572 B]
Get:14 http://httpredir.debian.org/debian/ jessie/main libnih1 amd64 1.0.3-4.3 [127 kB]
Get:15 http://httpredir.debian.org/debian/ jessie/main aufs-tools amd64 1:3.2+20130722-1.1 [92.9 kB]
[91mdebconf: delaying package configuration, since apt-utils is not installed
[0mFetched 10.3 MB in 3s (2588 kB/s)
Selecting previously unselected package makedev.
(Reading database ... 
(Reading database ... 5%
(Reading database ... 10%
(Reading database ... 15%
(Reading database ... 20%
(Reading database ... 25%
(Reading database ... 30%
(Reading database ... 35%
(Reading database ... 40%
(Reading database ... 45%
(Reading database ... 50%
(Reading database ... 55%
(Reading database ... 60%
(Reading database ... 65%
(Reading database ... 70%
(Reading database ... 75%
(Reading database ... 80%
(Reading database ... 85%
(Reading database ... 90%
(Reading database ... 95%
(Reading database ... 100%
(Reading database ... 20181 files and directories currently installed.)
Preparing to unpack .../makedev_2.3.1-93_all.deb ...
Unpacking makedev (2.3.1-93) ...
Selecting previously unselected package libklibc.
Preparing to unpack .../libklibc_2.0.4-2_amd64.deb ...
Unpacking libklibc (2.0.4-2) ...
Selecting previously unselected package klibc-utils.
Preparing to unpack .../klibc-utils_2.0.4-2_amd64.deb ...
Unpacking klibc-utils (2.0.4-2) ...
Selecting previously unselected package cpio.
Preparing to unpack .../cpio_2.11+dfsg-4.1_amd64.deb ...
Unpacking cpio (2.11+dfsg-4.1) ...
Selecting previously unselected package kmod.
Preparing to unpack .../archives/kmod_18-3_amd64.deb ...
Unpacking kmod (18-3) ...
Selecting previously unselected package busybox.
Preparing to unpack .../busybox_1%3a1.22.0-9+deb8u1_amd64.deb ...
Unpacking busybox (1:1.22.0-9+deb8u1) ...
Selecting previously unselected package initramfs-tools.
Preparing to unpack .../initramfs-tools_0.120_all.deb ...
Unpacking initramfs-tools (0.120) ...
Selecting previously unselected package plymouth.
Preparing to unpack .../plymouth_0.9.0-9_amd64.deb ...
Unpacking plymouth (0.9.0-9) ...
Selecting previously unselected package libnih1.
Preparing to unpack .../libnih1_1.0.3-4.3_amd64.deb ...
Unpacking libnih1 (1.0.3-4.3) ...
Selecting previously unselected package libnih-dbus1.
Preparing to unpack .../libnih-dbus1_1.0.3-4.3_amd64.deb ...
Unpacking libnih-dbus1 (1.0.3-4.3) ...
Selecting previously unselected package mountall.
Preparing to unpack .../mountall_2.54_amd64.deb ...
Unpacking mountall (2.54) ...
Selecting previously unselected package xz-utils.
Preparing to unpack .../xz-utils_5.1.1alpha+20120614-2+b3_amd64.deb ...
Unpacking xz-utils (5.1.1alpha+20120614-2+b3) ...
Selecting previously unselected package aufs-tools.
Preparing to unpack .../aufs-tools_1%3a3.2+20130722-1.1_amd64.deb ...
Unpacking aufs-tools (1:3.2+20130722-1.1) ...
Selecting previously unselected package cgroupfs-mount.
Preparing to unpack .../cgroupfs-mount_1.1_all.deb ...
Unpacking cgroupfs-mount (1.1) ...
Selecting previously unselected package docker-engine.
Preparing to unpack .../docker-engine_1.10.1-0~jessie_amd64.deb ...
Unpacking docker-engine (1.10.1-0~jessie) ...
Processing triggers for systemd (215-17+deb8u3) ...
Processing triggers for dbus (1.8.20-0+deb8u1) ...
Setting up makedev (2.3.1-93) ...
Setting up libklibc (2.0.4-2) ...
Setting up klibc-utils (2.0.4-2) ...
Setting up cpio (2.11+dfsg-4.1) ...
update-alternatives: using /bin/mt-gnu to provide /bin/mt (mt) in auto mode
Setting up kmod (18-3) ...
Setting up busybox (1:1.22.0-9+deb8u1) ...
Setting up initramfs-tools (0.120) ...
update-initramfs: deferring update (trigger activated)
Setting up plymouth (0.9.0-9) ...
update-initramfs: deferring update (trigger activated)
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
update-rc.d: warning: start and stop actions are no longer supported; falling back to defaults
Setting up libnih1 (1.0.3-4.3) ...
Setting up libnih-dbus1 (1.0.3-4.3) ...
Setting up mountall (2.54) ...
Setting up xz-utils (5.1.1alpha+20120614-2+b3) ...
update-alternatives: using /usr/bin/xz to provide /usr/bin/lzma (lzma) in auto mode
Setting up aufs-tools (1:3.2+20130722-1.1) ...
Setting up cgroupfs-mount (1.1) ...
invoke-rc.d: policy-rc.d denied execution of start.
Setting up docker-engine (1.10.1-0~jessie) ...
invoke-rc.d: policy-rc.d denied execution of start.
Processing triggers for systemd (215-17+deb8u3) ...
Processing triggers for initramfs-tools (0.120) ...
Processing triggers for libc-bin (2.19-18+deb8u3) ...
Processing triggers for dbus (1.8.20-0+deb8u1) ...

If you would like to use Docker as a non-root user, you should now consider
adding your user to the "docker" group with something like:

  sudo usermod -aG docker your-user

Remember that you will have to log out and back in for this to take effect!

 ---> 13e8a56b6805
Removing intermediate container 5babc8407fc1
Step 6 : RUN usermod -aG docker jenkins
 ---> Running in 071fdf12849f
 ---> 2040f8785389
Removing intermediate container 071fdf12849f
Step 7 : RUN curl -L https://github.com/docker/compose/releases/download/1.6.0/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose
 ---> Running in 219c3cc6d391
[91m  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[0m[91m
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[0m[91m
100   600    0   600    0     0   1251      0 --:--:-- --:--:-- --:--:--  1252
[0m[91m
  0 7754k    0 33346    0     0  28846      0  0:04:35  0:00:01  0:04:34 28846[0m[91m
[0m[91m 10 7754k   10  780k    0     0   357k      0  0:00:21  0:00:02  0:00:19  729k[0m[91m
[0m[91m 24 7754k   24 1903k    0     0   612k      0  0:00:12  0:00:03  0:00:09  958k[0m[91m
[0m[91m 37 7754k   37 2905k    0     0   697k      0  0:00:11  0:00:04  0:00:07  954k[0m[91m
 49 7754k   49 3875k    0     0   750k      0  0:00:10  0:00:05  0:00:05  959k[0m[91m
[0m[91m 62 7754k   62 4827k    0     0   781k      0  0:00:09  0:00:06  0:00:03  955k[0m[91m
 73 7754k   73 5676k    0     0   791k      0  0:00:09  0:00:07  0:00:02  981k[0m[91m
 84 77[0m[91m54k   84 6[0m[91m54[0m[91m4[0m[91mk[0m[91m [0m[91m [0m[91m [0m[91m [0m[91m0[0m[91m [0m[91m    0   801k      0  0:00:09  0:00:08  0:00:01  917k[0m[91m
 95 7754k   95 7428k    0     0   815k      0  0:00:09  0:00:0[0m[91m9 --:--:--  915k[0m[91m
[0m[91m1[0m[91m0[0m[91m0 7754k  100 7754k [0m[91m [0m[91m  0     0   817k      0  0:00:09  0:00:09 --:--:--  896k
[0m ---> 0415e5ee6558
Removing intermediate container 219c3cc6d391
Step 8 : RUN chmod +x /usr/local/bin/docker-compose
 ---> Running in 407a9ba1125e
 ---> 6a5a85d26205
Removing intermediate container 407a9ba1125e
Step 9 : COPY plugins.txt /usr/share/jenkins/plugins.txt
 ---> 18618159f3df
Removing intermediate container 86f336bef047
Step 10 : RUN dos2unix /usr/share/jenkins/plugins.txt
 ---> Running in eb80d177db9c
[91mdos2unix: converting file /usr/share/jenkins/plugins.txt to Unix format ...
[0m ---> e18fce9ccbc7
Removing intermediate container eb80d177db9c
Step 11 : RUN /usr/local/bin/plugins.sh /usr/share/jenkins/plugins.txt
 ---> Running in 903826d16ea3
Downloading ace-editor:1.0.1
Downloading ant:1.2
Downloading antisamy-markup-formatter:1.3
Downloading branch-api:1.1
Downloading build-flow-plugin:0.18
Downloading build-flow-test-aggregator:1.2
Downloading build-pipeline-plugin:1.4.9
Downloading cloudbees-folder:5.1
Downloading conditional-buildstep:1.3.3
Downloading credentials:1.24
Downloading cvs:2.12
Downloading dashboard-view:2.9.7
Downloading delivery-pipeline-plugin:0.9.8
Downloading docker-plugin:0.16.0
Downloading durable-task:1.7
Downloading envinject:1.92.1
Downloading external-monitor-job:1.4
Downloading ghprb:1.30.3
Downloading git:2.4.2
Downloading git-client:1.19.5
Downloading git-server:1.6
Downloading github:1.17.0
Downloading github-api:1.72
Downloading github-oauth:0.22.2
Downloading github-pullrequest:0.0.1-rc3
Downloading greenballs:1.15
Downloading groovy:1.29
Downloading htmlpublisher:1.11
Downloading javadoc:1.3
Downloading jenkins-multijob-plugin:1.20
Downloading job-dsl:1.43
Downloading jobConfigHistory:2.12
Downloading join:1.19
Downloading jquery:1.11.2-0
Downloading jquery-detached:1.2
Downloading junit:1.10
Downloading ldap:1.11
Downloading mailer:1.16
Downloading mapdb-api:1.0.6.0
Downloading matrix-auth:1.2
Downloading matrix-project:1.6
Downloading maven-plugin:2.12.1
Downloading mercurial:1.54
Downloading mock-slave:1.8
Downloading multiple-scms:0.5
Downloading pam-auth:1.2
Downloading parameterized-trigger:2.30
Downloading plain-credentials:1.1
Downloading promoted-builds:2.24.1
Downloading run-condition:1.0
Downloading scm-api:1.0
Downloading script-security:1.17
Downloading scriptler:2.9
Downloading sectioned-view:1.20
Downloading ssh-agent:1.9
Downloading ssh-credentials:1.11
Downloading ssh-slaves:1.10
Downloading subversion:2.5.7
Downloading token-macro:1.12.1
Downloading translation:1.12
Downloading view-job-filters:1.27
Downloading windows-slaves:1.1
Downloading workflow-aggregator:1.13
Downloading workflow-api:1.13
Downloading workflow-basic-steps:1.13
Downloading workflow-cps:1.13
Downloading workflow-cps-global-lib:1.13
Downloading workflow-durable-task-step:1.13
Downloading workflow-job:1.13
Downloading workflow-multibranch:1.13
Downloading workflow-scm-step:1.13
Downloading workflow-step-api:1.13
Downloading workflow-support:1.13
 ---> 777213faaca2
Removing intermediate container 903826d16ea3
Step 12 : COPY start.sh /tmp/start.sh
 ---> 2069d0907a25
Removing intermediate container d40291f412e3
Step 13 : RUN chmod +x /tmp/start.sh && dos2unix /tmp/start.sh
 ---> Running in ce17a61feac3
[91mdos2unix: [0m[91mconverting file /tmp/start.sh to Unix format ...
[0m ---> 8948f0346834
Removing intermediate container ce17a61feac3
Step 14 : COPY seed.groovy /usr/share/jenkins/ref/init.groovy.d/seed.groovy
 ---> 9072a6846c3d
Removing intermediate container f2652f931cab
Step 15 : RUN touch /var/run/docker.sock
 ---> Running in cf9faa187dc1
 ---> fc85e409d648
Removing intermediate container cf9faa187dc1
Step 16 : ENTRYPOINT /bin/bash -c /tmp/start.sh
 ---> Running in 7a874fdc7663
 ---> cbce69529702
Removing intermediate container 7a874fdc7663
Successfully built cbce69529702
build-yocto-slave uses an image, skipping
+ ./runme.sh
WARNING: Cannot find docker-machine - assuming environment variables are already defined
Creating network "workspace_default" with the default driver
Creating workspace_myjenkins_1
Pulling build-yocto-slave (gmacario/build-yocto:latest)...
latest: Pulling from gmacario/build-yocto
Digest: sha256:d28fdc101db00009a1c6a2eae4b715900d559701ea5b4a59f192f09e7c72d840
Status: Downloaded newer image for gmacario/build-yocto:latest
Creating workspace_build-yocto-slave_1
Notifying upstream projects of job completion
Finished: SUCCESS
```

~~**TODO**: Install docker 1.10.0 or later. See related https://github.com/gmacario/easy-jenkins/issues/35~~

~~**TODO**: Install docker-compose 1.6.0 or later. See related https://github.com/gmacario/easy-jenkins/issues/36~~

~~**TODO**: Handle case when no docker-machine installed. See related https://github.com/gmacario/easy-jenkins/pull/11~~

<!-- EOF -->
